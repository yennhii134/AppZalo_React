{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport React, { useEffect, useState, useRef } from \"react\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport Pressable from \"react-native-web/dist/exports/Pressable\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport ScrollView from \"react-native-web/dist/exports/ScrollView\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport ActivityIndicator from \"react-native-web/dist/exports/ActivityIndicator\";\nimport Modal from \"react-native-web/dist/exports/Modal\";\nimport { Ionicons } from \"@expo/vector-icons\";\nimport axiosInstance from \"../../../api/axiosInstance\";\nimport moment from 'moment-timezone';\nimport useMessage from \"../../../hooks/useMessage\";\nimport useSendMessage from \"../../../hooks/useSendMessage\";\nimport * as ImagePicker from \"expo-image-picker\";\nimport Toast from \"react-native-toast-message\";\nimport { FontAwesome5 } from \"@expo/vector-icons\";\nimport { useSocketContext } from \"../../../contexts/SocketContext\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nvar Message = function Message(_ref) {\n  var navigation = _ref.navigation,\n    route = _ref.route;\n  var user = route.params.user;\n  var _useState = useState(null),\n    _useState2 = _slicedToArray(_useState, 2),\n    textMessage = _useState2[0],\n    setTextMessage = _useState2[1];\n  var _useState3 = useState(false),\n    _useState4 = _slicedToArray(_useState3, 2),\n    isColorSend = _useState4[0],\n    setIsColorSend = _useState4[1];\n  var _useSendMessage = useSendMessage(),\n    sendMessage = _useSendMessage.sendMessage,\n    sendImage = _useSendMessage.sendImage,\n    sendVideo = _useSendMessage.sendVideo;\n  var _useState5 = useState(false),\n    _useState6 = _slicedToArray(_useState5, 2),\n    isMessageSent = _useState6[0],\n    setIsMessageSent = _useState6[1];\n  var _useState7 = useState(false),\n    _useState8 = _slicedToArray(_useState7, 2),\n    isLoadMess = _useState8[0],\n    setIsLoadMess = _useState8[1];\n  var _useSocketContext = useSocketContext(),\n    socket = _useSocketContext.socket;\n  var _useState9 = useState([]),\n    _useState10 = _slicedToArray(_useState9, 2),\n    chats = _useState10[0],\n    setChats = _useState10[1];\n  var scrollViewRef = useRef();\n  var _useState11 = useState(0),\n    _useState12 = _slicedToArray(_useState11, 2),\n    contentHeight = _useState12[0],\n    setContentHeight = _useState12[1];\n  var _useState13 = useState(0),\n    _useState14 = _slicedToArray(_useState13, 2),\n    scrollViewHeight = _useState14[0],\n    setScrollViewHeight = _useState14[1];\n  var _useState15 = useState(\"\"),\n    _useState16 = _slicedToArray(_useState15, 2),\n    lastTimestamp = _useState16[0],\n    setLastTimestamp = _useState16[1];\n  var _useState17 = useState(false),\n    _useState18 = _slicedToArray(_useState17, 2),\n    isLoad = _useState18[0],\n    setIsLoad = _useState18[1];\n  var _useState19 = useState(false),\n    _useState20 = _slicedToArray(_useState19, 2),\n    isLoading = _useState20[0],\n    setIsLoading = _useState20[1];\n  var _useMessage = useMessage(),\n    renderMessageContent = _useMessage.renderMessageContent,\n    showToastSuccess = _useMessage.showToastSuccess;\n  var _useState21 = useState(false),\n    _useState22 = _slicedToArray(_useState21, 2),\n    isModalVisible = _useState22[0],\n    setModalVisible = _useState22[1];\n  var _useState23 = useState(\"\"),\n    _useState24 = _slicedToArray(_useState23, 2),\n    messageSelected = _useState24[0],\n    setMessageSelected = _useState24[1];\n  var _useState25 = useState(false),\n    _useState26 = _slicedToArray(_useState25, 2),\n    isModalFriendVisible = _useState26[0],\n    setIsModalFriendVisible = _useState26[1];\n  var _useState27 = useState([]),\n    _useState28 = _slicedToArray(_useState27, 2),\n    friends = _useState28[0],\n    setFriends = _useState28[1];\n  var _useState29 = useState(false),\n    _useState30 = _slicedToArray(_useState29, 2),\n    isLoadChuyenTiep = _useState30[0],\n    setIsLoadChuyenTiep = _useState30[1];\n  var _useState31 = useState(false),\n    _useState32 = _slicedToArray(_useState31, 2),\n    isLoadThuHoi = _useState32[0],\n    setIsLoadThuHoi = _useState32[1];\n  var toggleModal = function toggleModal() {\n    setModalVisible(!isModalVisible);\n  };\n  var toggleModalFriend = function toggleModalFriend() {\n    setIsModalFriendVisible(!isModalFriendVisible);\n  };\n  var fetchFriends = function () {\n    var _ref2 = _asyncToGenerator(function* () {\n      try {\n        var response = yield axiosInstance.get('/users/get/friends');\n        setFriends(response.data.friends);\n      } catch (error) {\n        console.log(error);\n      }\n    });\n    return function fetchFriends() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n  useEffect(function () {\n    var fetchChats = function () {\n      var _ref3 = _asyncToGenerator(function* () {\n        try {\n          var response = yield axiosInstance.get(`/chats/${user.userId}`);\n          var reversedChats = response.data.data.reverse();\n          setChats(reversedChats);\n          fetchFriends();\n          var lastElement = reversedChats[0];\n          setLastTimestamp(lastElement.timestamp);\n        } catch (error) {\n          console.log(error);\n        }\n      });\n      return function fetchChats() {\n        return _ref3.apply(this, arguments);\n      };\n    }();\n    fetchChats();\n  }, [chats]);\n  var handleCheckIsSend = function handleCheckIsSend(message) {\n    if (message.senderId === user.userId) {\n      return false;\n    } else {\n      return true;\n    }\n  };\n  var handleGetTime = function handleGetTime(time) {\n    var vietnamDatetime = moment(time).tz('Asia/Ho_Chi_Minh').format('YYYY-MM-DD HH:mm:ss');\n    var dateObject = new Date(vietnamDatetime);\n    return `${dateObject.getHours()}:${dateObject.getMinutes()}`;\n  };\n  useEffect(function () {\n    if (scrollViewRef.current && contentHeight > scrollViewHeight && !isLoad) {\n      var offset = contentHeight - scrollViewHeight;\n      setIsLoad(true);\n      scrollViewRef.current.scrollTo({\n        x: 0,\n        y: offset,\n        animated: true\n      });\n    }\n  }, [contentHeight, scrollViewHeight]);\n  var handleGetModalFriend = function handleGetModalFriend() {\n    toggleModal();\n    toggleModalFriend();\n  };\n  var chuyenTiepChat = function chuyenTiepChat(friend) {\n    setIsLoadChuyenTiep(true);\n    var handleSendMessage = function () {\n      var _ref4 = _asyncToGenerator(function* () {\n        try {\n          var send = yield sendMessage(friend, messageSelected.contents[0]);\n          if (send) {\n            showToastSuccess(\"Chuyển tiếp thành công\");\n            setIsLoadChuyenTiep(false);\n          } else {\n            showToastError(\"Chuyển tiếp thất bại\");\n          }\n        } catch (error) {\n          console.log(\"error1:\", error);\n          setIsLoadChuyenTiep(false);\n          return false;\n        }\n        toggleModalFriend();\n      });\n      return function handleSendMessage() {\n        return _ref4.apply(this, arguments);\n      };\n    }();\n    handleSendMessage();\n  };\n  var openImagePicker = function () {\n    var _ref5 = _asyncToGenerator(function* () {\n      var permissionResult = yield ImagePicker.requestMediaLibraryPermissionsAsync();\n      if (!permissionResult.granted) {\n        console.log(\"Permission to access camera roll is required!\");\n        return;\n      }\n      var pickerResult = yield ImagePicker.launchImageLibraryAsync({\n        mediaTypes: ImagePicker.MediaTypeOptions.All,\n        allowsEditing: false,\n        quality: 1,\n        allowsMultipleSelection: true,\n        selectionLimit: 20,\n        videoExportPreset: ImagePicker.VideoExportPreset.Passthrough,\n        videoMaxDuration: 10\n      });\n      if (!pickerResult.canceled) {\n        setIsLoadMess(true);\n        var formData = new FormData();\n        for (var asset of pickerResult.assets) {\n          if (asset.type === 'image') {\n            pickerResult.assets.forEach(function (image) {\n              var fileName = image.uri.split('/').pop();\n              formData.append('data', {\n                uri: image.uri,\n                name: fileName,\n                type: 'image/jpeg'\n              });\n            });\n            try {\n              var send = yield sendImage(user, formData);\n              if (send) {\n                console.log(\"send image success\");\n                setIsLoadMess(false);\n              }\n            } catch (error) {\n              console.log(error);\n              setIsLoadMess(false);\n            }\n          } else if (asset.type === 'video') {\n            console.log(\"sendVideo\", asset);\n            pickerResult.assets.forEach(function (image) {\n              var fileName = image.uri.split('/').pop();\n              formData.append('data', {\n                uri: image.uri,\n                name: fileName,\n                type: 'video/mp4'\n              });\n            });\n            console.log(\"formData: \", formData);\n            try {\n              var _send = yield sendVideo(user, formData);\n              if (_send) {\n                console.log(\"send video success\");\n                setIsLoadMess(false);\n              }\n            } catch (error) {\n              console.log(error);\n              setIsLoadMess(false);\n            }\n          }\n        }\n      }\n    });\n    return function openImagePicker() {\n      return _ref5.apply(this, arguments);\n    };\n  }();\n  useEffect(function () {\n    if (!textMessage) {\n      setIsColorSend(\"black\");\n    } else {\n      setIsColorSend(\"#0091FF\");\n    }\n  }, [textMessage]);\n  useEffect(function () {\n    navigation.setOptions({\n      headerRight: function headerRight() {\n        return _jsxs(View, {\n          style: {\n            flexDirection: \"row\"\n          },\n          children: [_jsx(Pressable, {\n            onPress: function onPress() {\n              return console.log(\"Pressed call\");\n            },\n            children: _jsx(Ionicons, {\n              name: \"call-outline\",\n              size: 27,\n              color: \"white\",\n              style: {\n                padding: 5,\n                paddingStart: 15,\n                marginRight: 10\n              }\n            })\n          }), _jsx(Ionicons, {\n            name: \"videocam-outline\",\n            size: 27,\n            color: \"white\",\n            style: {\n              padding: 5,\n              marginRight: 10\n            }\n          }), _jsx(Pressable, {\n            onPress: function onPress() {\n              return navigation.navigate(\"MessageSettings\", {\n                friend: friend\n              });\n            },\n            children: _jsx(Ionicons, {\n              name: \"list-outline\",\n              size: 27,\n              color: \"white\",\n              style: {\n                padding: 5\n              }\n            })\n          })]\n        });\n      },\n      headerTitle: function headerTitle() {\n        return _jsx(View, {\n          style: {\n            flexDirection: \"row\",\n            alignItems: \"center\"\n          },\n          children: _jsx(Text, {\n            style: {\n              fontSize: 20,\n              color: 'white',\n              fontWeight: 'bold'\n            },\n            children: user.profile.name\n          })\n        });\n      },\n      headerStyle: {\n        backgroundColor: \"#0091FF\",\n        shadowColor: \"#fff\"\n      },\n      headerTintColor: \"#fff\",\n      headerTitleStyle: {\n        fontWeight: \"bold\",\n        fontSize: 20\n      }\n    });\n  }, [navigation]);\n  useEffect(function () {\n    if (scrollViewRef.current && contentHeight > scrollViewHeight && !isLoad) {\n      var offset = contentHeight - scrollViewHeight;\n      setIsLoad(true);\n      scrollViewRef.current.scrollTo({\n        x: 0,\n        y: offset,\n        animated: true\n      });\n    }\n  }, [contentHeight, scrollViewHeight]);\n  var restoreScrollPosition = function restoreScrollPosition() {\n    if (scrollViewRef.current) {\n      scrollViewRef.current.measure(function (x, y, width, height, pageX, pageY) {\n        scrollViewRef.current.scrollTo({\n          x: 0,\n          y: height + scrollViewHeight,\n          animated: false\n        });\n      });\n    }\n  };\n  var handleScrollToTop = function handleScrollToTop() {\n    setIsLoading(true);\n    var fetchChats = function () {\n      var _ref6 = _asyncToGenerator(function* () {\n        try {\n          var response = yield axiosInstance.get(`/chats/${user.userId}?lastTimestamp=${lastTimestamp}`);\n          var reversedChats = response.data.data.reverse();\n          if (reversedChats && reversedChats.length > 0) {\n            setChats(function (prevChats) {\n              return [].concat(_toConsumableArray(reversedChats), _toConsumableArray(prevChats));\n            });\n            restoreScrollPosition();\n            var lastElement = reversedChats[0];\n            setLastTimestamp(lastElement.timestamp);\n          }\n          setIsLoading(false);\n        } catch (error) {\n          console.log(error);\n        }\n      });\n      return function fetchChats() {\n        return _ref6.apply(this, arguments);\n      };\n    }();\n    fetchChats();\n  };\n  var handleScroll = function handleScroll(event) {\n    var y = event.nativeEvent.contentOffset.y;\n    if (y === 0) {\n      handleScrollToTop();\n    }\n  };\n  var handlePressIn = function handlePressIn(message) {\n    setMessageSelected(message);\n    setModalVisible(true);\n  };\n  var removeItemById = function removeItemById(array, idToRemove) {\n    var indexToRemove = array.findIndex(function (item) {\n      return item._id === idToRemove;\n    });\n    if (indexToRemove !== -1) {\n      array.splice(indexToRemove, 1);\n    }\n    return array;\n  };\n  var handleDeleteMess = function handleDeleteMess() {\n    var deleteChat = function () {\n      var _ref7 = _asyncToGenerator(function* () {\n        try {\n          var response = yield axiosInstance.post(`chats/${messageSelected._id}/delete`);\n          if (response.status === 200) {\n            var newArray = removeItemById(chats, messageSelected._id);\n            setChats(newArray);\n            showToastSuccess(\"Xóa thành công\");\n            toggleModal();\n          }\n        } catch (error) {\n          console.log(error);\n        }\n      });\n      return function deleteChat() {\n        return _ref7.apply(this, arguments);\n      };\n    }();\n    deleteChat();\n  };\n  useEffect(function () {\n    if (!textMessage) {\n      setIsColorSend(\"black\");\n    } else {\n      setIsColorSend(\"#0091FF\");\n    }\n  }, [textMessage]);\n  var handleSendMessage = function () {\n    var _ref8 = _asyncToGenerator(function* () {\n      if (!textMessage) {\n        console.log(\"message rỗng\");\n      } else {\n        setIsLoadMess(true);\n        try {\n          var response = yield sendMessage(user, {\n            type: 'text',\n            data: textMessage\n          });\n          if (response) {\n            setIsLoadMess(false);\n            setIsLoad(false);\n            setTextMessage(null);\n            setChats(chats.concat(response.data.data));\n            console.log(\"success\");\n          } else {\n            console.log(\"fail\");\n            setIsLoadMess(false);\n          }\n        } catch (error) {\n          console.log(error);\n          setIsLoadMess(false);\n        }\n      }\n    });\n    return function handleSendMessage() {\n      return _ref8.apply(this, arguments);\n    };\n  }();\n  return _jsxs(View, {\n    style: {\n      flex: 1,\n      backgroundColor: \"#E5E9EB\"\n    },\n    children: [_jsxs(View, {\n      style: {\n        flex: 1,\n        justifyContent: \"center\"\n      },\n      children: [isLoading ? _jsx(ActivityIndicator, {\n        color: \"blue\",\n        size: \"large\"\n      }) : _jsx(View, {}), _jsx(Toast, {}), _jsx(ScrollView, {\n        ref: scrollViewRef,\n        onScroll: handleScroll,\n        scrollEventThrottle: 16,\n        onLayout: function onLayout(event) {\n          setScrollViewHeight(event.nativeEvent.layout.height);\n        },\n        onContentSizeChange: function onContentSizeChange(width, height) {\n          setContentHeight(height);\n        },\n        children: _jsx(View, {\n          style: {\n            flex: 1,\n            justifyContent: \"flex-start\"\n          },\n          children: chats.map(function (message, index) {\n            return _jsx(View, {\n              style: {\n                justifyContent: 'space-around',\n                borderRadius: 10,\n                backgroundColor: handleCheckIsSend(message) ? \"#7debf5\" : \"#d9d9d9\",\n                margin: 5,\n                alignItems: handleCheckIsSend(message) ? \"flex-end\" : \"flex-start\",\n                alignSelf: handleCheckIsSend(message) ? \"flex-end\" : \"flex-start\"\n              },\n              children: _jsx(Pressable, {\n                onPress: function onPress() {\n                  return handlePressIn(message);\n                },\n                children: _jsxs(View, {\n                  children: [renderMessageContent(message), _jsx(View, {\n                    style: {\n                      paddingLeft: 15,\n                      paddingRight: 15,\n                      paddingBottom: 5\n                    },\n                    children: _jsx(Text, {\n                      style: {\n                        fontSize: 14\n                      },\n                      children: handleGetTime(message.timestamp)\n                    })\n                  })]\n                })\n              })\n            }, index);\n          })\n        })\n      })]\n    }), _jsxs(View, {\n      style: {\n        flexDirection: \"row\",\n        justifyContent: \"space-between\",\n        alignItems: \"center\",\n        padding: 10,\n        backgroundColor: \"white\",\n        height: 70\n      },\n      children: [_jsx(View, {\n        style: {\n          width: '10%'\n        },\n        children: _jsx(TouchableOpacity, {\n          onPress: function onPress() {\n            return console.log(\"Pressed smiley\");\n          },\n          children: _jsx(Ionicons, {\n            name: \"happy-outline\",\n            size: 30,\n            color: \"black\"\n          })\n        })\n      }), _jsx(View, {\n        style: {\n          width: '54%'\n        },\n        children: _jsx(TextInput, {\n          value: textMessage,\n          onChangeText: setTextMessage,\n          style: {\n            flex: 1,\n            height: 40,\n            borderColor: \"gray\",\n            borderRadius: 5,\n            fontSize: 17\n          },\n          placeholder: \"Tin nh\\u1EAFn\"\n        })\n      }), _jsxs(View, {\n        style: {\n          flexDirection: 'row',\n          width: '35%',\n          justifyContent: 'space-between'\n        },\n        children: [_jsx(TouchableOpacity, {\n          onPress: function onPress() {\n            return console.log(\"Pressed menu\");\n          },\n          children: _jsx(Ionicons, {\n            name: \"ellipsis-horizontal-outline\",\n            size: 30,\n            color: \"black\"\n          })\n        }), _jsx(TouchableOpacity, {\n          onPress: function onPress() {\n            return console.log(\"Pressed microphone\");\n          },\n          children: _jsx(Ionicons, {\n            name: \"mic-outline\",\n            size: 30,\n            color: \"black\"\n          })\n        }), _jsx(TouchableOpacity, {\n          onPress: openImagePicker,\n          children: _jsx(Ionicons, {\n            name: \"image-outline\",\n            size: 30,\n            color: \"black\"\n          })\n        }), _jsx(TouchableOpacity, {\n          onPress: handleSendMessage,\n          children: isLoadMess ? _jsx(ActivityIndicator, {\n            color: \"black\",\n            size: \"large\"\n          }) : _jsx(Ionicons, {\n            name: \"paper-plane\",\n            size: 30,\n            color: isColorSend\n          })\n        })]\n      })]\n    }), _jsx(Modal, {\n      animationType: \"slide\",\n      transparent: true,\n      visible: isModalVisible,\n      onRequestClose: toggleModal,\n      children: _jsx(View, {\n        style: styles.modalContainer,\n        children: _jsxs(View, {\n          style: styles.modalContent,\n          children: [_jsx(Text, {\n            style: styles.modalHeaderText,\n            children: \"Choose\"\n          }), _jsxs(View, {\n            style: styles.modalButtonContainer1,\n            children: [_jsxs(Pressable, {\n              style: styles.pressCol,\n              onPress: handleGetModalFriend,\n              children: [_jsx(FontAwesome5, {\n                name: \"share\",\n                size: 20,\n                color: \"black\",\n                style: {\n                  marginRight: 8\n                }\n              }), _jsx(Text, {\n                style: styles.modalButton,\n                children: \"Chuy\\u1EC3n ti\\u1EBFp\"\n              })]\n            }), _jsxs(Pressable, {\n              style: styles.pressCol,\n              children: [_jsx(FontAwesome5, {\n                name: \"trash\",\n                size: 20,\n                color: \"black\",\n                style: {\n                  marginRight: 8\n                }\n              }), _jsx(Text, {\n                style: styles.modalButton,\n                children: \"X\\xF3a\"\n              })]\n            }), _jsxs(Pressable, {\n              style: styles.pressCol,\n              onPress: handleDeleteMess,\n              children: [isLoadThuHoi ? _jsx(ActivityIndicator, {\n                color: \"black\",\n                size: \"large\"\n              }) : _jsx(FontAwesome5, {\n                name: \"comment-slash\",\n                size: 20,\n                color: \"black\",\n                style: {\n                  marginRight: 8\n                }\n              }), _jsx(Text, {\n                style: styles.modalButton,\n                children: \"Thu h\\u1ED3i\"\n              })]\n            })]\n          }), _jsx(View, {\n            style: styles.modalButtonContainer1,\n            children: _jsxs(Pressable, {\n              style: styles.pressCol,\n              children: [_jsx(FontAwesome5, {\n                name: \"list\",\n                size: 20,\n                color: \"black\",\n                style: {\n                  margin: 'auto'\n                }\n              }), _jsx(Text, {\n                style: styles.modalButton,\n                children: \"Ch\\u1ECDn nhi\\u1EC1u\"\n              })]\n            })\n          }), _jsxs(View, {\n            style: styles.modalButtonContainer,\n            children: [_jsx(Pressable, {\n              onPress: toggleModal,\n              children: _jsx(Text, {\n                style: styles.modalButton,\n                children: \"H\\u1EE6Y\"\n              })\n            }), _jsx(Pressable, {\n              children: _jsx(Text, {\n                style: styles.modalButton,\n                children: \"X\\xC1C NH\\u1EACN\"\n              })\n            })]\n          })]\n        })\n      })\n    }), _jsx(Modal, {\n      animationType: \"slide\",\n      transparent: true,\n      visible: isModalFriendVisible,\n      onRequestClose: toggleModalFriend,\n      children: _jsx(View, {\n        style: styles.modalContainer,\n        children: _jsxs(View, {\n          style: styles.modalContent,\n          children: [_jsx(Text, {\n            style: styles.modalHeaderText,\n            children: \"Choose\"\n          }), _jsx(View, {\n            style: styles.modalButtonContainer,\n            children: _jsx(ScrollView, {\n              children: _jsxs(View, {\n                style: styles.friendList,\n                children: [_jsxs(View, {\n                  style: styles.friendListHeader,\n                  children: [_jsx(Text, {\n                    style: styles.sectionTitle,\n                    children: \"#\"\n                  }), isLoadChuyenTiep ? _jsx(ActivityIndicator, {\n                    color: \"black\",\n                    size: \"large\"\n                  }) : _jsx(View, {})]\n                }), friends.map(function (friend, index) {\n                  var _friend$profile, _friend$profile$avata;\n                  return _jsx(View, {\n                    style: styles.friendRow,\n                    children: _jsxs(Pressable, {\n                      style: styles.friendItem,\n                      children: [_jsxs(View, {\n                        style: styles.friendInfo,\n                        children: [_jsx(Image, {\n                          source: {\n                            uri: friend == null ? void 0 : (_friend$profile = friend.profile) == null ? void 0 : (_friend$profile$avata = _friend$profile.avatar) == null ? void 0 : _friend$profile$avata.url\n                          },\n                          style: styles.friendAvatar\n                        }), _jsx(Text, {\n                          style: styles.friendName,\n                          children: friend.profile.name\n                        })]\n                      }), _jsx(View, {\n                        style: styles.friendActions,\n                        children: _jsx(Pressable, {\n                          onPress: function onPress() {\n                            return chuyenTiepChat(friend);\n                          },\n                          style: styles.pressCol,\n                          children: _jsx(FontAwesome5, {\n                            name: \"arrow-right\",\n                            size: 30,\n                            color: \"black\",\n                            style: {\n                              alignContent: \"center\",\n                              alignItems: \"center\"\n                            }\n                          })\n                        })\n                      })]\n                    })\n                  }, index);\n                })]\n              })\n            })\n          }), _jsxs(View, {\n            style: styles.modalButtonContainer,\n            children: [_jsx(Pressable, {\n              onPress: toggleModalFriend,\n              children: _jsx(Text, {\n                style: styles.modalButton,\n                children: \"H\\u1EE6Y\"\n              })\n            }), _jsx(Pressable, {\n              children: _jsx(Text, {\n                style: styles.modalButton,\n                children: \"X\\xC1C NH\\u1EACN\"\n              })\n            })]\n          })]\n        })\n      })\n    })]\n  });\n};\nvar styles = StyleSheet.create({\n  modalContainer: {\n    flex: 1,\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    backgroundColor: \"rgba(0,0,0,0.5)\"\n  },\n  modalContent: {\n    backgroundColor: \"#fff\",\n    width: 300,\n    padding: 20,\n    borderRadius: 10\n  },\n  modalHeaderText: {\n    fontWeight: \"bold\",\n    marginBottom: 10,\n    textAlign: \"center\"\n  },\n  modalText: {\n    marginBottom: 20\n  },\n  modalButtonContainer: {\n    flexDirection: \"row\",\n    justifyContent: \"flex-end\",\n    marginTop: 20\n  },\n  modalButton: {\n    fontWeight: \"bold\",\n    marginHorizontal: 10,\n    color: \"#0091FF\"\n  },\n  friendRow: {\n    paddingVertical: 10\n  },\n  friendItem: {\n    flexDirection: \"row\",\n    justifyContent: \"space-between\"\n  },\n  friendInfo: {\n    flexDirection: \"row\",\n    alignItems: \"center\"\n  },\n  friendAvatar: {\n    width: 50,\n    height: 50,\n    borderRadius: 25,\n    marginRight: 10\n  },\n  friendName: {\n    fontSize: 16\n  },\n  friendActions: {\n    flexDirection: \"row\"\n  },\n  actionIcon: {\n    marginRight: 20\n  },\n  friendList: {\n    backgroundColor: \"white\",\n    padding: 10,\n    borderTopColor: \"#e5e5e5\",\n    borderTopWidth: 0.5\n  },\n  friendListHeader: {\n    flexDirection: \"row\",\n    justifyContent: \"space-between\"\n  },\n  pressCol: {\n    justifyContent: 'center',\n    alignItems: 'center'\n  },\n  modalButtonContainer1: {\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n    alignItems: 'center',\n    marginTop: 20\n  }\n});\nexport default Message;","map":{"version":3,"names":["React","useEffect","useState","useRef","View","Text","TouchableOpacity","TextInput","Pressable","StyleSheet","ScrollView","Image","ActivityIndicator","Modal","Ionicons","axiosInstance","moment","useMessage","useSendMessage","ImagePicker","Toast","FontAwesome5","useSocketContext","jsx","_jsx","jsxs","_jsxs","Message","_ref","navigation","route","user","params","_useState","_useState2","_slicedToArray","textMessage","setTextMessage","_useState3","_useState4","isColorSend","setIsColorSend","_useSendMessage","sendMessage","sendImage","sendVideo","_useState5","_useState6","isMessageSent","setIsMessageSent","_useState7","_useState8","isLoadMess","setIsLoadMess","_useSocketContext","socket","_useState9","_useState10","chats","setChats","scrollViewRef","_useState11","_useState12","contentHeight","setContentHeight","_useState13","_useState14","scrollViewHeight","setScrollViewHeight","_useState15","_useState16","lastTimestamp","setLastTimestamp","_useState17","_useState18","isLoad","setIsLoad","_useState19","_useState20","isLoading","setIsLoading","_useMessage","renderMessageContent","showToastSuccess","_useState21","_useState22","isModalVisible","setModalVisible","_useState23","_useState24","messageSelected","setMessageSelected","_useState25","_useState26","isModalFriendVisible","setIsModalFriendVisible","_useState27","_useState28","friends","setFriends","_useState29","_useState30","isLoadChuyenTiep","setIsLoadChuyenTiep","_useState31","_useState32","isLoadThuHoi","setIsLoadThuHoi","toggleModal","toggleModalFriend","fetchFriends","_ref2","_asyncToGenerator","response","get","data","error","console","log","apply","arguments","fetchChats","_ref3","userId","reversedChats","reverse","lastElement","timestamp","handleCheckIsSend","message","senderId","handleGetTime","time","vietnamDatetime","tz","format","dateObject","Date","getHours","getMinutes","current","offset","scrollTo","x","y","animated","handleGetModalFriend","chuyenTiepChat","friend","handleSendMessage","_ref4","send","contents","showToastError","openImagePicker","_ref5","permissionResult","requestMediaLibraryPermissionsAsync","granted","pickerResult","launchImageLibraryAsync","mediaTypes","MediaTypeOptions","All","allowsEditing","quality","allowsMultipleSelection","selectionLimit","videoExportPreset","VideoExportPreset","Passthrough","videoMaxDuration","canceled","formData","FormData","asset","assets","type","forEach","image","fileName","uri","split","pop","append","name","setOptions","headerRight","style","flexDirection","children","onPress","size","color","padding","paddingStart","marginRight","navigate","headerTitle","alignItems","fontSize","fontWeight","profile","headerStyle","backgroundColor","shadowColor","headerTintColor","headerTitleStyle","restoreScrollPosition","measure","width","height","pageX","pageY","handleScrollToTop","_ref6","length","prevChats","concat","_toConsumableArray","handleScroll","event","nativeEvent","contentOffset","handlePressIn","removeItemById","array","idToRemove","indexToRemove","findIndex","item","_id","splice","handleDeleteMess","deleteChat","_ref7","post","status","newArray","_ref8","flex","justifyContent","ref","onScroll","scrollEventThrottle","onLayout","layout","onContentSizeChange","map","index","borderRadius","margin","alignSelf","paddingLeft","paddingRight","paddingBottom","value","onChangeText","borderColor","placeholder","animationType","transparent","visible","onRequestClose","styles","modalContainer","modalContent","modalHeaderText","modalButtonContainer1","pressCol","modalButton","modalButtonContainer","friendList","friendListHeader","sectionTitle","_friend$profile","_friend$profile$avata","friendRow","friendItem","friendInfo","source","avatar","url","friendAvatar","friendName","friendActions","alignContent","create","marginBottom","textAlign","modalText","marginTop","marginHorizontal","paddingVertical","actionIcon","borderTopColor","borderTopWidth"],"sources":["D:/HK2_Nam4/CNM/BTL/New_3/AppZalo_CNM/Frontend/Mobile/zalofake/src/components/ChatComponents/Message/Message.js"],"sourcesContent":["import React, { useEffect, useState, useRef } from \"react\";\r\nimport {\r\n  View,\r\n  Text,\r\n  TouchableOpacity,\r\n  TextInput,\r\n  Pressable,\r\n  StyleSheet,\r\n  ScrollView,\r\n  Image, ActivityIndicator,\r\n  Modal\r\n} from \"react-native\";\r\nimport { Ionicons } from \"@expo/vector-icons\";\r\nimport axiosInstance from \"../../../api/axiosInstance\";\r\nimport moment from 'moment-timezone';\r\nimport useMessage from '../../../hooks/useMessage'\r\nimport useSendMessage from \"../../../hooks/useSendMessage\";\r\nimport * as ImagePicker from \"expo-image-picker\";\r\nimport Toast from \"react-native-toast-message\";\r\nimport { FontAwesome5 } from \"@expo/vector-icons\";\r\nimport { useSocketContext } from \"../../../contexts/SocketContext\";\r\n\r\nconst Message = ({ navigation, route }) => {\r\n  const { user } = route.params;\r\n  const [textMessage, setTextMessage] = useState(null)\r\n  const [isColorSend, setIsColorSend] = useState(false)\r\n  const { sendMessage, sendImage, sendVideo } = useSendMessage();\r\n  const [isMessageSent, setIsMessageSent] = useState(false);\r\n  const [isLoadMess, setIsLoadMess] = useState(false)\r\n  const { socket } = useSocketContext();\r\n  // console.log(\"socket\", socket);\r\n  // truc {\r\n  const [chats, setChats] = useState([]);\r\n\r\n  const scrollViewRef = useRef();\r\n  const [contentHeight, setContentHeight] = useState(0);\r\n  const [scrollViewHeight, setScrollViewHeight] = useState(0);\r\n  const [lastTimestamp, setLastTimestamp] = useState(\"\")\r\n  const [isLoad, setIsLoad] = useState(false);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const { renderMessageContent, showToastSuccess } = useMessage();\r\n  const [isModalVisible, setModalVisible] = useState(false);\r\n  const [messageSelected, setMessageSelected] = useState(\"\");\r\n  const [isModalFriendVisible, setIsModalFriendVisible] = useState(false);\r\n  const [friends, setFriends] = useState([]);\r\n  const [isLoadChuyenTiep, setIsLoadChuyenTiep] = useState(false)\r\n  const [isLoadThuHoi, setIsLoadThuHoi] = useState(false)\r\n\r\n  const toggleModal = () => {\r\n    setModalVisible(!isModalVisible);\r\n  };\r\n  const toggleModalFriend = () => {\r\n    setIsModalFriendVisible(!isModalFriendVisible);\r\n  };\r\n  const fetchFriends = async () => {\r\n    try {\r\n      const response = await axiosInstance.get('/users/get/friends');\r\n      setFriends(response.data.friends);\r\n      // console.log(friends)\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    const fetchChats = async () => {\r\n      try {\r\n        const response = await axiosInstance.get(`/chats/${user.userId}`);\r\n        const reversedChats = response.data.data.reverse();\r\n        setChats(reversedChats);\r\n        fetchFriends();\r\n        const lastElement = reversedChats[0]\r\n        setLastTimestamp(lastElement.timestamp)\r\n      } catch (error) {\r\n        console.log(error);\r\n      }\r\n    };\r\n    fetchChats();\r\n\r\n   \r\n    \r\n    // if (isMessageSent) {\r\n    //   fetchChats();\r\n    //   setIsMessageSent(false);\r\n    // }\r\n\r\n    // }, [isMessageSent, chats]);\r\n  }, [chats]);\r\n\r\n  const handleCheckIsSend = (message) => {\r\n    if (message.senderId === user.userId) {\r\n      return false;\r\n    } else {\r\n      return true;\r\n    }\r\n  };\r\n  const handleGetTime = (time) => {\r\n    const vietnamDatetime = moment(time).tz('Asia/Ho_Chi_Minh').format('YYYY-MM-DD HH:mm:ss');\r\n    const dateObject = new Date(vietnamDatetime)\r\n    return `${dateObject.getHours()}:${dateObject.getMinutes()}`\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (scrollViewRef.current && contentHeight > scrollViewHeight && !isLoad) {\r\n      const offset = contentHeight - scrollViewHeight;\r\n      setIsLoad(true)\r\n      scrollViewRef.current.scrollTo({ x: 0, y: offset, animated: true });\r\n    }\r\n  }, [contentHeight, scrollViewHeight]);\r\n\r\n  const handleGetModalFriend = () => {\r\n    toggleModal();\r\n    toggleModalFriend();\r\n  };\r\n\r\n  const chuyenTiepChat = (friend) => {\r\n    setIsLoadChuyenTiep(true)\r\n    const handleSendMessage = async () => {\r\n      try {\r\n        const send = await sendMessage(friend, messageSelected.contents[0])\r\n        if (send) {\r\n          showToastSuccess(\"Chuyển tiếp thành công\")\r\n          setIsLoadChuyenTiep(false)\r\n        } else {\r\n          showToastError(\"Chuyển tiếp thất bại\")\r\n        }\r\n      } catch (error) {\r\n        console.log(\"error1:\", error)\r\n        setIsLoadChuyenTiep(false)\r\n        return false;\r\n      }\r\n      toggleModalFriend();\r\n    }\r\n    handleSendMessage();\r\n  };\r\n  // }\r\n\r\n  // nhi {\r\n  const openImagePicker = async () => {\r\n    const permissionResult =\r\n      await ImagePicker.requestMediaLibraryPermissionsAsync();\r\n    if (!permissionResult.granted) {\r\n      console.log(\"Permission to access camera roll is required!\");\r\n      return;\r\n    }\r\n\r\n    const pickerResult = await ImagePicker.launchImageLibraryAsync({\r\n      mediaTypes: ImagePicker.MediaTypeOptions.All,\r\n      allowsEditing: false,\r\n      quality: 1,\r\n      allowsMultipleSelection: true,\r\n      selectionLimit: 20,\r\n      videoExportPreset: ImagePicker.VideoExportPreset.Passthrough,\r\n      videoMaxDuration: 10\r\n    });\r\n\r\n    if (!pickerResult.canceled) {\r\n      setIsLoadMess(true)\r\n      const formData = new FormData();\r\n      for (const asset of pickerResult.assets) {\r\n        if (asset.type === 'image') {\r\n          pickerResult.assets.forEach(image => {\r\n            const fileName = image.uri.split('/').pop();\r\n            formData.append('data', {\r\n              uri: image.uri,\r\n              name: fileName,\r\n              type: 'image/jpeg',\r\n            });\r\n          });\r\n\r\n          try {\r\n            const send = await sendImage(user, formData)\r\n            if (send) {\r\n              console.log(\"send image success\");\r\n              setIsLoadMess(false)\r\n            }\r\n          } catch (error) {\r\n            console.log(error);\r\n            setIsLoadMess(false)\r\n          }\r\n        } else if (asset.type === 'video') {\r\n          console.log(\"sendVideo\", asset);\r\n          pickerResult.assets.forEach(image => {\r\n            const fileName = image.uri.split('/').pop();\r\n            formData.append('data', {\r\n              uri: image.uri,\r\n              name: fileName,\r\n              type: 'video/mp4',\r\n            });\r\n          });\r\n\r\n          console.log(\"formData: \", formData);\r\n\r\n          try {\r\n            const send = await sendVideo(user, formData)\r\n            if (send) {\r\n              console.log(\"send video success\");\r\n              setIsLoadMess(false)\r\n            }\r\n          } catch (error) {\r\n            console.log(error);\r\n            setIsLoadMess(false)\r\n          }\r\n        }\r\n\r\n      }\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    // Update send button color based on textMessage\r\n    if (!textMessage) {\r\n      setIsColorSend(\"black\");\r\n    } else {\r\n      setIsColorSend(\"#0091FF\");\r\n    }\r\n  }, [textMessage]);\r\n\r\n\r\n  // }\r\n  useEffect(() => {\r\n    navigation.setOptions({\r\n      headerRight: () => (\r\n        <View style={{ flexDirection: \"row\" }}>\r\n          <Pressable onPress={() => console.log(\"Pressed call\")}>\r\n            <Ionicons\r\n              name=\"call-outline\"\r\n              size={27}\r\n              color=\"white\"\r\n              style={{ padding: 5, paddingStart: 15, marginRight: 10 }}\r\n            />\r\n          </Pressable>\r\n          <Ionicons\r\n            name=\"videocam-outline\"\r\n            size={27}\r\n            color=\"white\"\r\n            style={{ padding: 5, marginRight: 10 }}\r\n          />\r\n          <Pressable\r\n            onPress={() => navigation.navigate(\"MessageSettings\", { friend })}\r\n          >\r\n            <Ionicons\r\n              name=\"list-outline\"\r\n              size={27}\r\n              color=\"white\"\r\n              style={{ padding: 5 }}\r\n            />\r\n          </Pressable>\r\n        </View>\r\n      ),\r\n      headerTitle: () => (\r\n        <View style={{ flexDirection: \"row\", alignItems: \"center\" }}>\r\n          <Text style={{ fontSize: 20, color: 'white', fontWeight: 'bold' }}>{user.profile.name}</Text>\r\n        </View>\r\n      ),\r\n      headerStyle: {\r\n        backgroundColor: \"#0091FF\",\r\n        shadowColor: \"#fff\",\r\n      },\r\n      headerTintColor: \"#fff\",\r\n      headerTitleStyle: {\r\n        fontWeight: \"bold\",\r\n        fontSize: 20,\r\n      },\r\n    });\r\n  }, [navigation]);\r\n\r\n  useEffect(() => {\r\n    if (scrollViewRef.current && contentHeight > scrollViewHeight && !isLoad) {\r\n      const offset = contentHeight - scrollViewHeight;\r\n      setIsLoad(true)\r\n      scrollViewRef.current.scrollTo({ x: 0, y: offset, animated: true });\r\n    }\r\n  }, [contentHeight, scrollViewHeight]);\r\n\r\n\r\n  // Khôi phục vị trí cuộn của ScrollView\r\n  const restoreScrollPosition = () => {\r\n\r\n    if (scrollViewRef.current) {\r\n      scrollViewRef.current.measure((x, y, width, height, pageX, pageY) => {\r\n        scrollViewRef.current.scrollTo({ x: 0, y: height + scrollViewHeight, animated: false });\r\n\r\n      });\r\n    }\r\n  };\r\n  const handleScrollToTop = () => {\r\n    setIsLoading(true)\r\n    const fetchChats = async () => {\r\n      try {\r\n        const response = await axiosInstance.get(`/chats/${user.userId}?lastTimestamp=${lastTimestamp}`);\r\n        const reversedChats = response.data.data.reverse();\r\n        if (reversedChats && reversedChats.length > 0) {\r\n          setChats(prevChats => [...reversedChats, ...prevChats]);\r\n          restoreScrollPosition();\r\n          const lastElement = reversedChats[0]\r\n          setLastTimestamp(lastElement.timestamp)\r\n        }\r\n        setIsLoading(false)\r\n\r\n      } catch (error) {\r\n        console.log(error);\r\n      }\r\n    };\r\n    fetchChats();\r\n\r\n  };\r\n  const handleScroll = (event) => {\r\n    const { y } = event.nativeEvent.contentOffset;\r\n    if (y === 0) {\r\n      handleScrollToTop();\r\n    }\r\n  };\r\n  const handlePressIn = (message) => {\r\n    setMessageSelected(message)\r\n    setModalVisible(true)\r\n  };\r\n  const removeItemById = (array, idToRemove) => {\r\n    const indexToRemove = array.findIndex(item => item._id === idToRemove);\r\n    if (indexToRemove !== -1) {\r\n      array.splice(indexToRemove, 1);\r\n    }\r\n    return array;\r\n  };\r\n  const handleDeleteMess = () => {\r\n    const deleteChat = async () => {\r\n      try {\r\n        const response = await axiosInstance.post(`chats/${messageSelected._id}/delete`);\r\n        if (response.status === 200) {\r\n          const newArray = removeItemById(chats, messageSelected._id);\r\n          setChats(newArray)\r\n          showToastSuccess(\"Xóa thành công\")\r\n          toggleModal()\r\n        }\r\n      } catch (error) {\r\n        console.log(error);\r\n      }\r\n    };\r\n    deleteChat();\r\n    // setModalVisible(false)\r\n  };\r\n\r\n\r\n\r\n  //nhi\r\n\r\n\r\n\r\n  useEffect(() => {\r\n    // Update send button color based on textMessage\r\n    if (!textMessage) {\r\n      setIsColorSend(\"black\");\r\n    } else {\r\n      setIsColorSend(\"#0091FF\");\r\n    }\r\n  }, [textMessage]);\r\n\r\n  const handleSendMessage = async () => {\r\n    if (!textMessage) {\r\n      console.log(\"message rỗng\");\r\n    }\r\n    else {\r\n      setIsLoadMess(true)\r\n      try {\r\n        const response = await sendMessage(user,\r\n          { type: 'text', data: textMessage })\r\n        if (response) {\r\n          setIsLoadMess(false)\r\n          setIsLoad(false)\r\n          setTextMessage(null)\r\n          setChats(\r\n            chats.concat(response.data.data))\r\n          console.log(\"success\");\r\n        }\r\n        else {\r\n          console.log(\"fail\");\r\n          setIsLoadMess(false)\r\n        }\r\n\r\n      } catch (error) {\r\n        console.log(error);\r\n        setIsLoadMess(false)\r\n      }\r\n    }\r\n  }\r\n\r\n  return (\r\n    <View style={{ flex: 1, backgroundColor: \"#E5E9EB\" }}>\r\n      <View style={{ flex: 1, justifyContent: \"center\" }}>\r\n        {isLoading ? (\r\n          <ActivityIndicator color=\"blue\" size=\"large\" />\r\n        ) : (\r\n          <View></View>\r\n        )}\r\n        <Toast />\r\n        <ScrollView ref={scrollViewRef}\r\n          onScroll={handleScroll}\r\n          scrollEventThrottle={16}\r\n          onLayout={(event) => {\r\n            setScrollViewHeight(event.nativeEvent.layout.height);\r\n          }}\r\n          onContentSizeChange={(width, height) => {\r\n            setContentHeight(height);\r\n          }}\r\n        >\r\n          <View style={{ flex: 1, justifyContent: \"flex-start\" }}>\r\n            {chats.map((message, index) => (\r\n              <View key={index} style={{ justifyContent: 'space-around', borderRadius: 10, backgroundColor: handleCheckIsSend(message) ? \"#7debf5\" : \"#d9d9d9\", margin: 5, alignItems: handleCheckIsSend(message) ? \"flex-end\" : \"flex-start\", alignSelf: handleCheckIsSend(message) ? \"flex-end\" : \"flex-start\" }}>\r\n                <Pressable\r\n                  onPress={() => handlePressIn(message)}\r\n                >\r\n                  <View>\r\n                    {renderMessageContent(message)}\r\n                    <View style={{ paddingLeft: 15, paddingRight: 15, paddingBottom: 5 }}><Text style={{ fontSize: 14 }}>{handleGetTime(message.timestamp)}</Text></View>\r\n                  </View>\r\n                </Pressable>\r\n              </View>\r\n            ))}\r\n          </View>\r\n        </ScrollView>\r\n      </View >\r\n      <View\r\n        style={{\r\n          flexDirection: \"row\",\r\n          justifyContent: \"space-between\",\r\n          alignItems: \"center\",\r\n          padding: 10,\r\n          backgroundColor: \"white\",\r\n          height: 70\r\n        }}\r\n      >\r\n        <View style={{ width: '10%' }}>\r\n          <TouchableOpacity onPress={() => console.log(\"Pressed smiley\")}>\r\n            <Ionicons name=\"happy-outline\" size={30} color=\"black\" />\r\n          </TouchableOpacity>\r\n        </View>\r\n\r\n        <View style={{ width: '54%' }}>\r\n          <TextInput\r\n            value={textMessage}\r\n            onChangeText={setTextMessage}\r\n            style={{\r\n              flex: 1,\r\n              height: 40,\r\n              borderColor: \"gray\",\r\n              borderRadius: 5,\r\n              fontSize: 17\r\n            }}\r\n            placeholder=\"Tin nhắn\"\r\n          />\r\n        </View>\r\n        <View style={{ flexDirection: 'row', width: '35%', justifyContent: 'space-between' }}>\r\n          <TouchableOpacity onPress={() => console.log(\"Pressed menu\")}>\r\n            <Ionicons\r\n              name=\"ellipsis-horizontal-outline\"\r\n              size={30}\r\n              color=\"black\"\r\n            />\r\n          </TouchableOpacity>\r\n\r\n          <TouchableOpacity onPress={() => console.log(\"Pressed microphone\")}>\r\n            <Ionicons\r\n              name=\"mic-outline\"\r\n              size={30}\r\n              color=\"black\"\r\n            />\r\n          </TouchableOpacity>\r\n\r\n          <TouchableOpacity onPress={openImagePicker}>\r\n            <Ionicons name=\"image-outline\" size={30} color=\"black\" />\r\n          </TouchableOpacity>\r\n\r\n          <TouchableOpacity onPress={handleSendMessage}>\r\n            {isLoadMess ? (\r\n              <ActivityIndicator color=\"black\" size=\"large\" />\r\n            ) : (\r\n              <Ionicons name=\"paper-plane\" size={30} color={isColorSend} />\r\n            )}\r\n          </TouchableOpacity>\r\n        </View>\r\n      </View>\r\n      <Modal\r\n        animationType=\"slide\"\r\n        transparent={true}\r\n        visible={isModalVisible}\r\n        onRequestClose={toggleModal}\r\n      >\r\n        <View style={styles.modalContainer}>\r\n          <View style={styles.modalContent}>\r\n            <Text style={styles.modalHeaderText}>\r\n              Choose\r\n            </Text>\r\n            <View style={styles.modalButtonContainer1}>\r\n              <Pressable style={styles.pressCol} onPress={handleGetModalFriend}>\r\n                <FontAwesome5\r\n                  name=\"share\"\r\n                  size={20}\r\n                  color=\"black\"\r\n                  style={{ marginRight: 8 }}\r\n                />\r\n                <Text style={styles.modalButton}>Chuyển tiếp</Text>\r\n              </Pressable>\r\n              <Pressable style={styles.pressCol}>\r\n                <FontAwesome5\r\n                  name=\"trash\"\r\n                  size={20}\r\n                  color=\"black\"\r\n                  style={{ marginRight: 8 }}\r\n                />\r\n                <Text style={styles.modalButton} >Xóa</Text>\r\n              </Pressable>\r\n              <Pressable style={styles.pressCol} onPress={handleDeleteMess}>\r\n                {isLoadThuHoi ? (\r\n                  <ActivityIndicator color=\"black\" size=\"large\" />\r\n                ) : (\r\n                  <FontAwesome5\r\n                    name=\"comment-slash\"\r\n                    size={20}\r\n                    color=\"black\"\r\n                    style={{ marginRight: 8 }}\r\n                  />\r\n                )}\r\n\r\n                <Text style={styles.modalButton}>Thu hồi</Text>\r\n              </Pressable>\r\n            </View>\r\n            <View style={styles.modalButtonContainer1}>\r\n              <Pressable style={styles.pressCol}>\r\n                <FontAwesome5\r\n                  name=\"list\"\r\n                  size={20}\r\n                  color=\"black\"\r\n                  style={{ margin: 'auto' }}\r\n                />\r\n                <Text style={styles.modalButton}>Chọn nhiều</Text>\r\n              </Pressable>\r\n\r\n            </View>\r\n            <View style={styles.modalButtonContainer}>\r\n              <Pressable onPress={toggleModal}>\r\n                <Text style={styles.modalButton}>HỦY</Text>\r\n              </Pressable>\r\n              <Pressable >\r\n\r\n                <Text style={styles.modalButton}>XÁC NHẬN</Text>\r\n\r\n              </Pressable>\r\n            </View>\r\n          </View>\r\n        </View>\r\n      </Modal>\r\n      <Modal\r\n        animationType=\"slide\"\r\n        transparent={true}\r\n        visible={isModalFriendVisible}\r\n        onRequestClose={toggleModalFriend}\r\n      >\r\n        <View style={styles.modalContainer}>\r\n          <View style={styles.modalContent}>\r\n            <Text style={styles.modalHeaderText}>\r\n              Choose\r\n            </Text>\r\n            <View style={styles.modalButtonContainer}>\r\n              <ScrollView>\r\n                <View style={styles.friendList}>\r\n                  <View style={styles.friendListHeader}>\r\n                    <Text style={styles.sectionTitle}>#</Text>\r\n                    {isLoadChuyenTiep ? (\r\n                      <ActivityIndicator color=\"black\" size=\"large\" />\r\n                    ) : (\r\n                      <View></View>\r\n                    )}\r\n                  </View>\r\n                  {friends.map((friend, index) => (\r\n                    <View key={index} style={styles.friendRow}>\r\n                      <Pressable style={styles.friendItem} >\r\n                        <View style={styles.friendInfo}>\r\n\r\n                          <Image\r\n                            source={{\r\n                              uri: friend?.profile?.avatar?.url,\r\n                            }}\r\n                            style={styles.friendAvatar}\r\n                          />\r\n                          <Text style={styles.friendName}>{friend.profile.name}</Text>\r\n                        </View>\r\n                        <View style={styles.friendActions}>\r\n                          <Pressable onPress={() => chuyenTiepChat(friend)} style={styles.pressCol}>\r\n\r\n\r\n                            <FontAwesome5\r\n                              name=\"arrow-right\"\r\n                              size={30}\r\n                              color=\"black\"\r\n                              style={{ alignContent: \"center\", alignItems: \"center\" }}\r\n                            />\r\n\r\n                          </Pressable>\r\n                        </View>\r\n                      </Pressable>\r\n                    </View>\r\n                  ))}\r\n                </View>\r\n              </ScrollView>\r\n            </View>\r\n            <View style={styles.modalButtonContainer}>\r\n              <Pressable onPress={toggleModalFriend}>\r\n                <Text style={styles.modalButton}>HỦY</Text>\r\n              </Pressable>\r\n              <Pressable >\r\n                <Text style={styles.modalButton}>XÁC NHẬN</Text>\r\n              </Pressable>\r\n            </View>\r\n          </View>\r\n        </View>\r\n      </Modal>\r\n    </View >\r\n  );\r\n};\r\nconst styles = StyleSheet.create({\r\n  modalContainer: {\r\n    flex: 1,\r\n\r\n    justifyContent: \"center\",\r\n    alignItems: \"center\",\r\n    backgroundColor: \"rgba(0,0,0,0.5)\",\r\n  },\r\n  modalContent: {\r\n    backgroundColor: \"#fff\",\r\n    width: 300,\r\n    padding: 20,\r\n    borderRadius: 10,\r\n  },\r\n  modalHeaderText: {\r\n    fontWeight: \"bold\",\r\n    marginBottom: 10,\r\n    textAlign: \"center\",\r\n  },\r\n  modalText: {\r\n    marginBottom: 20,\r\n  },\r\n  modalButtonContainer: {\r\n    flexDirection: \"row\",\r\n    justifyContent: \"flex-end\",\r\n    marginTop: 20\r\n  },\r\n  modalButton: {\r\n    fontWeight: \"bold\",\r\n    marginHorizontal: 10,\r\n    color: \"#0091FF\",\r\n  },\r\n  friendRow: {\r\n    paddingVertical: 10,\r\n  },\r\n  friendItem: {\r\n    flexDirection: \"row\",\r\n    justifyContent: \"space-between\",\r\n  },\r\n  friendInfo: {\r\n    flexDirection: \"row\",\r\n    alignItems: \"center\",\r\n  },\r\n  friendAvatar: {\r\n    width: 50,\r\n    height: 50,\r\n    borderRadius: 25,\r\n    marginRight: 10,\r\n  },\r\n  friendName: {\r\n    fontSize: 16,\r\n  },\r\n  friendActions: {\r\n    flexDirection: \"row\",\r\n  },\r\n  actionIcon: {\r\n    marginRight: 20,\r\n  },\r\n  friendList: {\r\n    backgroundColor: \"white\",\r\n    padding: 10,\r\n    borderTopColor: \"#e5e5e5\",\r\n    borderTopWidth: 0.5,\r\n  },\r\n  friendListHeader: {\r\n    flexDirection: \"row\",\r\n    justifyContent: \"space-between\",\r\n  },\r\n  pressCol: {\r\n    // flexDirection: \"column\",\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n  },\r\n  modalButtonContainer1: {\r\n    // flex:1,\r\n    // height: 300,\r\n    // width: 450,\r\n    flexDirection: \"row\",\r\n    justifyContent: \"space-between\",\r\n    alignItems: 'center',\r\n    marginTop: 20\r\n  },\r\n});\r\nexport default Message;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}